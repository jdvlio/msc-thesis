\chapter{Dense linear orders}


\section{The shuffle operation}

\begin{prp}\label{prp:ratpart}
	Suppose $n\in\nats$ and $n\geq 2$ and let $P$ bet a set of $n-1$ primes $p\in\nats$.  Choose
	\begin{equation}
		D_p=\setbuild{q=\faktor{a}{p^k}}{a\in\ints\text{ and }k\in\ints\setminus\set{0}},\quad\text{for each }p\in P.
	\end{equation}
	If $P=\set{p_0,\dotsc,p_{n-2}}$ and $Q_i=\setbuild{D_p}{p\in P}$ when $i<n$ and $Q_n=\rats\setminus\bigcup_{i<n}Q_i$ then $\setbuild{Q_i}{0\leq i<n}$ is a partition of $\rats$ such that $Q_i$ is dense in $\eta$, for each $i=0,\dotsc,n-1$.
\end{prp}

\begin{dfn}[Canonical partition]
	The partition defined in proposition \ref{prp:ratpart} will be referred to as the \textbf{canonical partion} of the rationals into dense subsets.
\end{dfn}

\begin{cor}
	For every natural $n\geq 2$ there exists a partition $\mathcal{R}=\set{R_0,\dotsc,R_{n-1}}$ of $\reals$ such that:
	\begin{enumerate}
		\item $R_{n-1}=\irrats$,
		\item $R_k$ is a countable dense subset of $\lambda$, for each natural $k<n-1$.
	\end{enumerate}
\end{cor}

\begin{dfn}[The shuffle operation]
	Suppose $n\in\nats$ and let $F=\set{\alpha_0,\dotsc,\alpha_{n-1}}$ be an arbitrary set of $n$ linear orders.  Now suppose the following:
	\begin{enumerate}
		\item $\set{Q_0,\dotsc,Q_{n-1}}$ is the canonical partition of $\rats$,
		\item $h\colon\rats\to F$ is a colouring of $\eta$ such that $\inv{h}[\alpha_i]=Q_i$, for each natural $i<n$.
	\end{enumerate}
	We then define the \textbf{shuffle} $\sigma(F)$ of the set $F$ to be the linear order
	\begin{equation}
		\sigma(\set{\alpha_0,\dotsc,\alpha_{n-1}})=\sum_{q\in\eta}h(q),
	\end{equation}
	and we refer to the resulting (class) map $\sigma$ as the \textbf{shuffle operation} induced by the aforementioned partition.
\end{dfn}


\section{The L\"auchli and Leonard result for the class of linear orders}

\begin{dfn}[The class $\M$]
	The class $\M$ is the smallest class of linear orders such that the following holds:
	\begin{enumerate}
		\item	$\zero,\one\in\M$,
		\item	if $\alpha,\beta\in\M$ then $\alpha+\beta\in\M$,
		\item	if $\alpha\in\M$ then $\alpha\cdot\omega,\alpha\cdot\dual{\omega}\in\M$,
		\item	for every finite $F\subseteq\M$, it holds that $\sigma(F)\in\M$.
	\end{enumerate}
\end{dfn}

\begin{prp}\label{prp:Msumint}
	If $\alpha_i\in\M$ for each $i\in\ints$ then there exists a $\beta\in\M$ such that\
	\begin{equation}
		\sum_{i\in\zeta}\alpha_i\nequiv{n}\beta.
	\end{equation}
\end{prp}
\begin{proof}
	Since $\M$ is closed under finite sums as well as right multiplication by $\omega$ and $\dual{\omega}$, results analagous to propositions \ref{prp:M0sum} and \ref{prp:M0sumop} can be proven in the context of $\M$.  An argument similar to that which appears in the proof of proposition \ref{prp:M0sumint} then yields the desired result.
\end{proof}

\begin{thm}[L\"auchli and Leonard]
	For every countable linear order $\alpha$, and every $n\in\nats$, there exists some $\beta_n\in\M$ such that $\alpha\nequiv{n}\beta_n$.
\end{thm}
\begin{proof}
	Define a binary relation $R$ on $\alpha$ such that, for every $x,y\in\alpha$, $xRy$ iff $x\leq y$ and there exists a $\beta\in\M$ such that $[x,y]\nequiv{n}\beta$.  Since $R$ is clearly transitive (simply note $\M$ is closed under finite sums), it induces a congruence $\sim$ on $\alpha$.    We now claim the following:
	\begin{claim}
		For every $\gamma\in\faktor{\alpha}{\sim}$, there exists a $\beta\in\M$ such that $\gamma\nequiv{n}\beta$.
	\end{claim}
	\begin{proof}
		Fix any $\gamma\in\faktor{\alpha}{\sim}$ and note that $\M$ contains all finite ordinals so we may assume, without loss of generality, that $\gamma$ is infinite.  Consequently, at least one of $\omega$ and $\dual{\omega}$ is embeddable in $\gamma$.  There must then exist a family $\family{\gamma_i}{i\in\zeta}$ of (possibly empty) linear orders such that
		\begin{equation}
			\gamma\cong\sum_{i\in\zeta}\gamma_i.
		\end{equation}
		By definition of $\sim$ it now follows that there exists a $\gamma_i^\prime\in\M$, for each $i\in\ints$, such that $\gamma_i\nequiv{n}\gamma_i^\prime$.  Proposition \ref{prp:Msumint} then implies that there exists a $\gamma^\prime\in\M$ such that
		\begin{equation}
			\gamma^\prime\nequiv{n}\sum_{i\in\zeta}\gamma_i^\prime.
		\end{equation}
		From lemma \ref{lem:fvsum} we may conclude that
		\begin{equation}
			\gamma\nequiv{n}\sum_{i\in\zeta}\gamma_i^\prime\nequiv{n}\gamma^\prime,
		\end{equation}
		establishing the claim.
	\end{proof}

	Note that if $\card{\faktor{\alpha}{\sim}}=1$ then our task is complete so suppose, by way of contradiction, that $\card{\faktor{\alpha}{\sim}}>1$.
	\begin{claim}
		$\faktor{\alpha}{\sim}$ is dense.
	\end{claim}
	\begin{proof}
		With our goal being a contradiction, suppose that $\faktor{\alpha}{\sim}$ is not dense.  Therefore, there exists $a,b\in\alpha$ such that $a<b$, $a\not\sim b$ and for every $c\in(a,b)$ either $c\sim a$ or $c\sim b$ but not both.  Note that, since $a\not\sim b$, the interval $(a,b)$ cannot be finite.  Therefore, $(a,b)\cong\sum_{i\in\zeta}\gamma_i$ where $\gamma_i$ is $n$-equivalent to some member $\gamma_i^\prime$ of $\M$, for each $i\in\ints$.  Thus, by proposition \ref{prp:Msumint}, $(a,b)\nequiv{n}\gamma$ for some $\gamma\in\M$.  Since $\one+\gamma+\one\nequiv{n}[a,b]$ by lemma \ref{lem:fvsum} and $\one+\gamma+\one$ is a member of $\M$, it follows by definition that $a\sim b$ --- a contradiction.
	\end{proof}

	Now choose $K=\set{\chi_0,\dotsc,\chi_{m-1}}$, for some $m\in\posnats$, to be an $n$-spectrum for the class $\setbuild{\chi\in\M}{\chi\nequiv{n}\gamma,\text{ for some }\gamma\in\faktor{\alpha}{\sim}}$.
	\begin{claim}
		There exists a maximal $F\subseteq K$ and a nonempty interval $I=(A,B)$ of $\faktor{\alpha}{\sim}$ such that, for every $\chi\in F$, the set $D_\chi(I)=\setbuild{\gamma\in I}{\gamma\nequiv{n}\chi}$ is dense in $I$.
	\end{claim}
	\begin{proof}
		Argue by induction on $m$.  If $m=1$ then, since $\faktor{\alpha}{\sim}$ is dense we can choose any $A,B\in\faktor{\alpha}{\sim}$ such that $A<B$ and it will immediately follow that if $I=(A,B)$ then $D_{\chi_0}(I)$ is dense in $I$, since every member of $\faktor{\alpha}{\sim}$ is $n$-equivalent to $\chi_0$.

		Assume now that the claim holds for each $m<m^\prime\in\posnats$.  Let $m=m^\prime$ and suppose to the contrary that for every $F^\prime\subseteq K$ and every (nonempty) open interval $J\subseteq\faktor{\alpha}{\sim}$ there exists some $\chi_k\in F^\prime$ such that $0\leq k<m$ and $D_{\chi_k}(J)$ is not dense in $J$.  Note that, by assumption, there must exist a $\chi\in K$ such that $D_{\chi}(\faktor{\alpha}{\sim})$ is not dense in $\faktor{\alpha}{\sim}$.  Without loss of generality we may assume that $\chi=\chi_{m-1}$ and consequently there exists a (nonempty) open subset $J$ of $\faktor{\alpha}{\sim}$ such that $D_{\chi_{m-1}}(J)$ is not dense in $J$.  Note in particular that we can choose $J$ such that $\chi_{m-1}$ has no $n$-equivalent in $J$.

		By definition, there exists an $F^\prime\subseteq\set{\chi_0,\dotsc,\chi_{m-2}}$ which is an $n$-spectrum for the class $\setbuild{\chi^\prime\in\M}{\chi\nequiv{n}\gamma\text{ for some }\gamma\in J}$.  It then follows from the inductive hypothesis that there exists a maximal $F\subseteq F^\prime$ and some open interval $I=(A,B)\subseteq J$, where $A<B$, such that $D_{\chi}(I)$ is dense in $I$, for each $\chi\in F$.  Since $\chi_{m-1}\notin J\supseteq I$, it follows that $\chi_{m-1}$ is not dense in $I$ and, consequently, $F\subseteq K$ is maximal, as required.  This is the sought-after contradiction, thus establishing the claim.
	\end{proof}
	Note that $F$ is now an $n$-spectrum for the class
	\begin{equation}
		\setbuild{\chi\in\M}{\chi\nequiv{n}\gamma\text{ for some }\gamma\in I}.
	\end{equation}
	Consequently, since $D_{\chi}(I)$ is dense in $I$ for each $\chi\in F$, it follows that
	\begin{equation}
		\sigma(F)\nequiv{n}\sum I=\sum_{\gamma\in I}\gamma.
	\end{equation}
	Therefore, since $\sigma(F)\in\M$, it follows that $I$ has exactly one element.  This then contradicts the fact that $I$ is an open interval.  Hence, we may now conclude that $\faktor{\alpha}{\sim}$ has only one element, yielding the result.

\end{proof}

\begin{lem}
	The set $\setbuild{(\alpha,\sigma)}{\alpha\in\M\text{ and }\alpha\models\sigma}$ is recursively enumerable.  Assume, by way of contradiction, that for some natural $k<m^\prime$ it holds that $D_{\chi_k}$ is not dense in $I$.
\end{lem}

\begin{thm}
	The theory of linear orders is decidable.
\end{thm}


\section{Model-theoretic aspects of the class \text{$\dense$}}

\begin{thm}[Cantor's Theorem]\label{thm:cantor}
	If $\alpha\in\dense$ is countable then there exists an isomorphism $f\colon\alpha\to\eta$.
\end{thm}
\begin{proof}
	We will construct the required isomorphism by means of the game $\EF_\omega(\alpha,\eta)$. It is reasonable to assume that $\Left$ never plays an element more than once in the game $\EF_\omega(\alpha,\eta)$ as $\Right$ could then simply respond by copying his previous countermove to that element.

	Regardless of what initial move  $\Left$ makes, $e_0$ say, we let $\Right$ respond with $a_0$ if $e_0\in\rats$ and with $b_0$ if $e_0\in\alpha$.  Suppose now that we are on round $n$ and $\Left$ has just played the element $e_{n-1}$.  Label the elements in $\alpha$ that have already been played as $\nu_0,\dotsc,\nu_{n-2}$ and the elements that have been played in $\eta$ as $\xi_0,\dotsc,\xi_{n-2}$.  Without loss of generality we may assume $\nu_0<\dotsb<\nu_{n-2}$ and $\xi_0<\dotsb<\xi_{n-2}$.  We consider only the case $e_{n-1}\in\rats$ as the case $e_{n-1}\in\alpha$ is argued similarly.  Since $\alpha$ has no least or greatest element, if $e_{n-1}>\xi_{n-2}$ then $\Right$ plays the first entry in $\bar{a}$ that has yet to be played and is greater than $\nu_{n-2}$ and if $e_{n-1}<\xi_0$ then $\Right$ plays the first entry in $\bar{a}$ which is less than $\nu_0$ but has yet to be played.  Otherwise, there exists some $i_0<n-1$ such that $\nu_{i_0}<e_{n-1}<\nu_{i_0+1}$.  In this latter scenario we let $\Right$ play the first entry in $\bar{a}$ that has not yet been played and is a member of the interval $(\xi_{i_0},\xi_{i_0+1})$.

	Suppose the resulting play of the game is now $(\bar{c},\bar{d})$.  Since $\Left$ never played an element twice, we can define a function $f\colon\eta\to\alpha$ such that $f(c_i)=f(d_i)$, for each $i<\omega$.  Let $f_n$ denote the restriction $f_n=f\restriction\set{c_0,\dotsc,c_{n-1}}$, for each $n\in\nats$.  We aim now to show that $f$ is the desired isomorphism via the following claim:
	\begin{claim}
		For each $n\in\nats$, the map $f_n\colon\set{c_0,\dotsc,c_{n-1}}\to\set{d_0,\dotsc,d_{n-1}}$ is an isomorpshim.
	\end{claim}
	\begin{proof}
		The case $n=0$ is immediate from the definition.  Suppose now that $f_{n-1}$ is an isomorphism for some $n\in\nats$ and fix any $i<n-1$.  If $c_i<c_{n-1}$ then, by definition, $d_i=f(c_i)<d_{n-1}=f(c_{n-1})$. Similarly, if $c_{n-1}<c_i$ then $d_{n-1}=f(c_{n-1})<d_i=f(c_i)$.  It then follows necessarily from the inductive hypothesis that $f_n$ is a homomorphism.  From these observations one may also conclude that $f_n$ is bijective and thus in fact an isomorphism.
	\end{proof}
	It now remains but a simple exercise to show that, since each $f_n$ for $n\in\nats$ is an isomorphism, that $f$ itself is also an isomorphism.
\end{proof}

\begin{prp}\label{prp:xcantor}
	If $\alpha\in\dense$ is countable and, for some $n\in\nats$, we fix any $\bar{a}\in\domain{n}\alpha$ and any $\bar{b}\in\rats^n$ then there exists an isomorphism $f\colon\alpha\to\eta$ such that $f[\bar{a}]=\bar{b}$.
\end{prp}
\begin{proof}
	We prooceed by means of induction, nothing that the case $n=0$ is Cantor's Theorem (Theorem \ref{thm:cantor}).  Suppose now the result holds for each $k\leq n$ for some arbtrary $n\in\nats$ and note that we may assume $\bar{a}=(a_0,\dotsc,a_n)$ and $\bar{b}=(b_0,\dotsc,a_n)$ such that $a_i<a_j$ and $b_i<b_j$, whenever $i<j<\omega$.  It now follows from the inductive hypothesis that there exists isomoprhisms $f_0\colon\alpha^{<a_0}\to\eta^{<b_0}$ and $f_1\colon(\alpha^{>a_0},a_1,\dotsc,a_n)\to(\beta^{>a_0},b_1,\dotsc,b_n)$.  By identifying $f_0$ and $f_1$ with their (respective) underlying sets, we may define the new map $f\colon\alpha\to\beta$ such that $f=f_0\cup\set{(a_0,b_0)}\cup f_1$.  By definition, we have thusly obtained an order-preserving map $f\colon(\alpha,\bar{a})\to(\beta,\bar{b})$.  It is not difficult to see, simply from its definition, that $f$ is in fact an isomorphism $f\colon\alpha\to\beta$ satisfying $f[\bar{a}]=\bar{b}$, as required.
\end{proof}

As a consequence of the previous proposition we get the following:
\begin{prp}
	The linear order $\eta$ is saturated.
\end{prp}
\begin{proof}
	Choose any finite $A\subseteq\rats$.  Suppose that $\Phi(x)\subseteq L_1(A)$ is an $1$-type of $\eta$ over $A$.  By definition there exists a $\alpha\succcurlyeq\eta$ such that $\Phi$ is realised by some $b\in\alpha$ i.e.\ $\alpha\models\Phi(b)$.  By the Downwards L\"owhenheim-Skolem Theorem, however, we may assume that $\alpha$ is countable.  We may assume that $A=\set{a_0,\dotsc,a_{k-1}}$ and thus, from Proposition \ref{prp:xcantor}, if $\bar{a}=(a_0,\dotsc,a_{k-1})$ then there must exist an isomorphism $f\colon(\eta,\bar{a})\to(\alpha,\bar{a})$.  Therefore, it must follow that $\eta\models\varphi(f(b))$, for each $\varphi\in\Phi(x)$, and thus $\Phi(x)$ is realised by the element $f(b)\in\rats$.
\end{proof}


\begin{thm}
	The linear order $\eta$ is a prime model of the theory $\Th(\dense)$.
\end{thm}
\begin{proof}
	Suppose $\alpha\models\Th(\dense)$ then $\alpha$ must be infinite and thus, from the downward L\"owenheim-Skolem Theorem, there exists a countable $\alpha_0\preccurlyeq\alpha$.  From Cantor's theorem it follows that $\alpha_0\cong\eta$ and, therefore, there must exist an elementary embedding of $\eta$ into $\alpha$.
\end{proof}

\begin{thm}
	The theory $T=\Th(\dense)$ has quantifier elimination.
\end{thm}
\begin{proof}
	By Lemma \ref{lem:qelim}, it is enough to show that $T$ is substructure complete.  Suppose that $\alpha\models T$ and choose any $\alpha_0\subseteq\alpha$.  Define $A=\domain{}\alpha_0$ and suppose that $\mathfrak{M},\mathfrak{N}\models T\cup\diag{\alpha_0}$ are $L(A)$-structures.  Note that we may assume, without loss of generality, that $A\subseteq M,N$ such that $\mathfrak{M}=(\beta,A)$ and $\mathfrak{N}=(\gamma,A)$ for linear orders $\beta,\gamma\models T$.  We are now required to show that
	\begin{equation}
		\mathfrak{M}\equiv\mathfrak{N}.
	\end{equation}
	However, it is enough to simply prove that
	\begin{equation}
		(\beta,B)\equiv(\gamma,B),\quad\text{for every finite }B\subseteq A.
	\end{equation}

	Suppose that $B\subseteq A$ is finite then by the downwards L\"owenheim-Skolem Theorem there exists countable $\beta_0\elmsub\beta$ and $\gamma_0\elmsub\gamma$ such that $B\subseteq\beta_0,\gamma_0$.  We may assume that the elements of $B$, for some $n\in\nats$, are precisely $b_0<b_1<\dotsb<b_{n-1}$.  It now follows from Cantor's Theorem that each of the intervals $(b_0,b_1)_{\beta_0},\dotsc,(b_{n-2},b_{n-1})_{\beta_0}$ as well as $\beta_0^{<b_0}$ and $\beta_0^{>b_{n-1}}$ are isomorphic to $\eta$.  The same is true of the corresponding intervals in $\gamma_0$.  This then gives rise to isomorphisms $f_0,\dotsc,f_n$ (whose domains we will choose to be subsets of $\domain{}\beta_0$) between the corresponding open intervals of $\beta_0$ and $\gamma_0$ such that each member of the range of $f_i$ is less (in $\gamma_0$) than every member member of the range of $f_j$ whenever $i<j\leq n$.  One can then define (in an obvious manner) an isomorphism $f\colon\beta_0\to\gamma_0$ which is an extension of $f_i$ to all of $\beta_0$, for each $i\leq n$, such that $f(b_j)=b_j$ whenever $j<n$.  Therefore, since no element of $B$ is an endpoint of either $\beta_0$ or $\gamma_0$, it follows that $(\beta_0,B)\cong(\gamma_0,B)$ and thus $(\beta_0,B)\equiv(\gamma_0,B)$.  The proof is then concluded by recalling that $\beta_0\elmsub\beta$ and $\gamma_0\elmsub\gamma$.
\end{proof}

\begin{cor}
	The theory $T=\Th(\dense)$ is model-complete.
\end{cor}
\begin{proof}
	Immediate from the previous theorem and Corollary \ref{cor:qemc}.
\end{proof}

We've already seen that $\eta$ is saturated and can thus be thought of from an intuitive standpoint as being very ``thick'' among linear orders.  Contrary to what one might expect, though, the next result shows that $\eta$ is simultaneously also an atomic structure and can therefore be thought of as being very ``thin''!

\begin{prp}
	The linear order $\eta$ is atomic.
\end{prp}
\begin{proof}
	Let $T=\Th(\dense)$ then the result follows from the fact that $T$ admits quantifier elimination and the fact that there are only finitely many inequivalent formulas in finitely many variables in a finitary language.
\end{proof}
